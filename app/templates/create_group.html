<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Create Student Group</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    .flash-message {
      animation: fadeIn 0.5s, fadeOut 0.5s 4.5s;
      animation-fill-mode: forwards;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    @keyframes fadeOut {
      from { opacity: 1; }
      to { opacity: 0; }
    }
    .progress-ring {
      transform: rotate(-90deg);
    }
    .progress-ring-circle {
      transition: stroke-dashoffset 0.35s;
      stroke-dasharray: 251.2 251.2;
    }
    .student-avatar {
      background-color: #4f46e5;
      color: white;
    }
    .hover-scale {
      transition: transform 0.2s;
    }
    .hover-scale:hover {
      transform: scale(1.02);
    }
  </style>
</head>
<body class="bg-gray-50">
  <!-- Flash Messages -->
  <div class="fixed top-4 right-4 z-50 space-y-2">
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="flash-message px-4 py-3 rounded-md shadow-lg {% if category == 'error' %}bg-red-100 text-red-800 border border-red-200{% elif category == 'success' %}bg-green-100 text-green-800 border border-green-200{% elif category == 'warning' %}bg-yellow-100 text-yellow-800 border border-yellow-200{% else %}bg-blue-100 text-blue-800 border border-blue-200{% endif %}">
            <div class="flex items-center">
              {% if category == 'error' %}<i class="fas fa-exclamation-circle mr-2"></i>{% endif %}
              {% if category == 'success' %}<i class="fas fa-check-circle mr-2"></i>{% endif %}
              {% if category == 'warning' %}<i class="fas fa-exclamation-triangle mr-2"></i>{% endif %}
              {{ message }}
            </div>
          </div>
        {% endfor %}
      {% endif %}
    {% endwith %}
  </div>

  <!-- Navigation -->
  <nav class="bg-white shadow-sm">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between h-16">
        <div class="flex">
          <div class="flex-shrink-0 flex items-center">
            <i class="fas fa-graduation-cap text-indigo-600 text-2xl mr-2"></i>
            <span class="font-bold text-xl text-gray-800">Collabo Group</span>
          </div>
          <div class="hidden sm:ml-6 sm:flex sm:space-x-8">
            <a href="#" class="border-indigo-500 text-gray-900 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">
              Groups
            </a>
            <a href="#" class="border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">
              Courses
            </a>
            <a href="#" class="border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">
              Students
            </a>
            <a href="{{ url_for('main.instructor_dashboard') }}" class="border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">
              Dashboard
            </a>
          </div>
        </div>
        <div class="flex items-center">
          
          <div class="ml-3 relative">
            <div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <div class="min-h-screen p-6">
    <div class="max-w-7xl mx-auto">
      <!-- Page Header -->
      <header class="mb-8">
        <div class="flex flex-col md:flex-row md:items-center md:justify-between">
          <div>
            <h1 class="text-3xl font-bold text-gray-800 mb-2">Create a Collaborative Student Group</h1>
            <p class="text-gray-600 max-w-2xl">Organize students, assign tasks, and track deadlines all in one place.</p>
          </div>
        </div>
      </header>

      <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <!-- Left Column: Group Creation Form -->
        <div class="bg-white rounded-xl shadow-md p-6 hover-scale">
          <div class="flex justify-between items-center mb-4">
            <h2 class="text-xl font-semibold text-gray-800 flex items-center">
              <i class="fas fa-users-cog mr-2 text-indigo-600"></i>New Group Details
            </h2>
            <span class="text-sm text-gray-500">* Required fields</span>
          </div>
          
          <form method="POST" action="{{ url_for('main.create_group') }}" class="space-y-6" id="group-form">
            <input type="hidden" name="action" value="create">
            
            <!-- Group Details Section -->
            <div class="bg-gray-50 p-4 rounded-lg">
              <h3 class="text-lg font-medium text-gray-700 mb-3 flex items-center">
                <i class="fas fa-info-circle mr-2 text-indigo-500"></i>Group Information
              </h3>
              <div class="space-y-4">
                <div>
                  <label for="group_name" class="block text-sm font-medium text-gray-700 mb-1">
                    Group Name <span class="text-red-500">*</span>
                  </label>
                  <input type="text" name="group_name" id="group_name" required 
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                </div>
                
                <div>
                  <label for="course_id" class="block text-sm font-medium text-gray-700 mb-1">
                    Course <span class="text-red-500">*</span>
                  </label>
                  <select name="course_id" id="course_id" required 
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    <option value="">Select a course</option>
                    {% for course in courses %}
                    <option value="{{ course.id }}">{{ course.title }}</option>
                    {% endfor %}
                  </select>
                </div>
                
                <div>
                  <label for="visibility" class="block text-sm font-medium text-gray-700 mb-1">Visibility</label>
                  <div class="flex space-x-4">
                    <label class="inline-flex items-center">
                      <input type="radio" name="visibility" value="private" checked class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300">
                      <span class="ml-2 text-sm text-gray-700">Private (only group members)</span>
                    </label>
                    <label class="inline-flex items-center">
                      <input type="radio" name="visibility" value="public" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300">
                      <span class="ml-2 text-sm text-gray-700">Public (visible to all students)</span>
                    </label>
                  </div>
                </div>

                {% if max_members_exists %}
                <div>
                  <label for="max_members" class="block text-sm font-medium text-gray-700 mb-1">Maximum Members</label>
                  <input type="number" name="max_members" id="max_members" min="2" max="20" value="5" 
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                  <p class="mt-1 text-xs text-gray-500">Set a limit for group size (2-20 students)</p>
                </div>
                {% endif %}
              </div>
            </div>
            
            <!-- Task Assignment Section -->
            <div class="bg-gray-50 p-4 rounded-lg">
              <h3 class="text-lg font-medium text-gray-700 mb-3 flex items-center">
                <i class="fas fa-tasks mr-2 text-indigo-500"></i>Task Assignment
              </h3>
              <div class="space-y-4">
                <div>
                  <label for="project_title" class="block text-sm font-medium text-gray-700 mb-1">
                    Task Title <span class="text-red-500">*</span>
                  </label>
                  <input type="text" name="project_title" id="project_title" required 
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                </div>
                
                <div>
                  <label for="task_description" class="block text-sm font-medium text-gray-700 mb-1">
                    Task Description <span class="text-red-500">*</span>
                  </label>
                  <textarea name="task_description" id="task_description" rows="4" required 
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"></textarea>
                </div>
                
                <div class="grid grid-cols-2 gap-4">
                  <div>
                    <label for="deadline" class="block text-sm font-medium text-gray-700 mb-1">
                      Deadline <span class="text-red-500">*</span>
                    </label>
                    <input type="date" name="deadline" id="deadline" required 
                      class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                  </div>
                  
                  {% if priority_exists %}
                  <div>
                    <label for="priority" class="block text-sm font-medium text-gray-700 mb-1">Priority</label>
                    <select name="priority" id="priority" 
                      class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                      <option value="low">Low</option>
                      <option value="medium" selected>Medium</option>
                      <option value="high">High</option>
                    </select>
                  </div>
                  {% endif %}
                </div>
              </div>
            </div>
            
            <!-- Student Selection Section -->
            <div class="bg-gray-50 p-4 rounded-lg">
              <h3 class="text-lg font-medium text-gray-700 mb-3 flex items-center">
                <i class="fas fa-user-friends mr-2 text-indigo-500"></i>Select Students
              </h3>
              
              <!-- Search Box -->
              <div class="mb-3">
                <div class="relative">
                  <input type="text" id="student-search" placeholder="Search students..." 
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                  <i class="fas fa-search absolute right-3 top-3 text-gray-400"></i>
                </div>
              </div>
              
              <!-- Filter by Course -->
              <div class="mb-3">
                <label class="block text-sm font-medium text-gray-700 mb-1">Filter by Course</label>
                <select id="course-filter" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                  <option value="">All Courses</option>
                  {% for course in courses %}
                  <option value="{{ course.id }}">{{ course.title }}</option>
                  {% endfor %}
                </select>
              </div>
              
              <!-- Select All/Deselect All -->
              <div class="mb-3 flex justify-between items-center">
                <div>
                  <input type="checkbox" id="select-all-students" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded">
                  <label for="select-all-students" class="ml-2 text-sm text-gray-700">Select All</label>
                </div>
                <span id="selected-count" class="text-sm text-gray-600">0 selected</span>
              </div>
              
              <!-- Student List -->
              <div class="max-h-60 overflow-y-auto border border-gray-200 rounded-md p-2" id="student-list">
                {% if all_students %}
                  {% for student in all_students %}
                    <label class="student-item flex items-center p-2 hover:bg-gray-100 rounded-md cursor-pointer" data-student-name="{{ student.full_name|lower }}" data-course-id="{{ student.course_id }}">
                      <input type="checkbox" name="students[]" value="{{ student.id }}" 
                        class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded student-checkbox">
                      <div class="ml-3 flex items-center">
                        <div class="h-8 w-8 rounded-full student-avatar flex items-center justify-center mr-2">
                          <span class="text-white font-medium">{{ student.full_name|first|upper }}</span>
                        </div>
                        <div>
                          <span class="block text-sm font-medium text-gray-700">{{ student.full_name }}</span>
                          <span class="block text-xs text-gray-500">{{ student.email }}</span>
                        </div>
                      </div>
                    </label>
                  {% endfor %}
                {% else %}
                  <div class="text-center py-6">
                    <i class="fas fa-user-slash text-gray-300 text-3xl mb-3"></i>
                    <p class="text-gray-500">No students available in the system.</p>
                    <p class="text-gray-400 text-sm mt-1">Please add students to create groups.</p>
                  </div>
                {% endif %}
              </div>
            </div>
            
            <!-- Submit Button -->
            <div class="pt-4">
              <button type="submit" class="w-full bg-indigo-600 text-white py-3 px-4 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 flex items-center justify-center">
                <i class="fas fa-plus-circle mr-2"></i>Create Group & Assign Task
              </button>
            </div>
          </form>
        </div>
        
        <!-- Right Column: Existing Groups -->
        <div>
          <div class="flex justify-between items-center mb-4">
            <h2 class="text-xl font-semibold text-gray-800 flex items-center">
              <i class="fas fa-layer-group mr-2 text-indigo-600"></i>Existing Groups
            </h2>
            <div class="flex space-x-2">
              <select id="sort-groups" class="text-sm border border-gray-300 rounded-md px-2 py-1 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                <option value="newest">Sort by: Newest</option>
                <option value="oldest">Sort by: Oldest</option>
                <option value="name">Sort by: Name</option>
                <option value="deadline">Sort by: Deadline</option>
              </select>
            </div>
          </div>
          
          <!-- Stats Overview -->
          <div class="grid grid-cols-3 gap-4 mb-6">
            <div class="bg-white rounded-lg shadow p-4 text-center">
              <div class="text-2xl font-bold text-indigo-600">{{ created_groups|length }}</div>
              <div class="text-sm text-gray-600">Total Groups</div>
            </div>
            <div class="bg-white rounded-lg shadow p-4 text-center">
              <div class="text-2xl font-bold text-green-600" id="active-groups">0</div>
              <div class="text-sm text-gray-600">Active Groups</div>
            </div>
            <div class="bg-white rounded-lg shadow p-4 text-center">
              <div class="text-2xl font-bold text-yellow-600" id="pending-tasks">0</div>
              <div class="text-sm text-gray-600">Pending Tasks</div>
            </div>
          </div>
          
          {% if created_groups %}
            <div class="space-y-6" id="groups-container">
              {% for group in created_groups %}
                <div class="bg-white rounded-xl shadow-md overflow-hidden hover-scale group-item" data-deadline="{{ group.deadline.strftime('%Y-%m-%d') }}" data-name="{{ group.name }}">
                  <!-- Group Header -->
                  <div class="bg-indigo-50 p-4 border-b border-indigo-100">
                    <div class="flex justify-between items-start">
                      <div>
                        <h3 class="text-lg font-semibold text-gray-800">{{ group.name }}</h3>
                        <p class="mt-1 text-gray-600"><strong>Course:</strong> {{ group.course_title }}</p>
                        <p class="text-sm text-gray-600"><strong>Task:</strong> {{ group.project_title }}</p>
                      </div>
                      <div class="flex flex-col items-end">
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium 
                          {% if group.visibility == 'private' %}bg-purple-100 text-purple-800{% else %}bg-blue-100 text-blue-800{% endif %}">
                          {{ group.visibility|capitalize }}
                        </span>
                        {% if priority_exists and group.priority == 'high' %}
                          <span class="mt-2 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">
                            <i class="fas fa-exclamation-circle mr-1"></i>High Priority
                          </span>
                        {% endif %}
                      </div>
                    </div>
                    <div class="mt-3 flex items-center justify-between">
                      <p class="text-sm text-gray-500">
                        <i class="far fa-calendar-alt mr-1"></i>Deadline: {{ group.deadline.strftime('%Y-%m-%d') }}
                      </p>
                      <div class="flex items-center">
                        <span class="text-sm text-gray-500 mr-2">Progress:</span>
                        <div class="relative w-10 h-10">
                          <svg class="progress-ring w-10 h-10">
                            <circle class="text-gray-200" stroke="currentColor" stroke-width="3" fill="transparent" r="16" cx="20" cy="20"></circle>
                            <circle class="progress-ring-circle text-indigo-600" stroke="currentColor" stroke-width="3" fill="transparent" r="16" cx="20" cy="20" style="stroke-dashoffset: 125.6;"></circle>
                          </svg>
                          <div class="absolute inset-0 flex items-center justify-center">
                            <span class="text-xs font-medium text-gray-700">50%</span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Group Members -->
                  <div class="p-4">
                    <div class="flex justify-between items-center mb-2">
                      <h4 class="text-sm font-medium text-gray-700">Group Members ({{ group.members|length }}{% if max_members_exists and group.max_members %}/{{ group.max_members }}{% endif %})</h4>
                      <span class="text-xs text-gray-500">
                        {% if group.members|length < 2 %}Need more members{% elif max_members_exists and group.max_members and group.members|length >= group.max_members %}Full team{% else %}Accepting members{% endif %}
                      </span>
                    </div>
                    {% if group.members %}
                      <div class="flex flex-wrap gap-2">
                        {% for member in group.members %}
                          <div class="flex items-center text-sm bg-gray-50 rounded-full px-3 py-1">
                            <div class="h-6 w-6 rounded-full bg-indigo-100 flex items-center justify-center mr-1">
                              <span class="text-indigo-800 text-xs font-medium">{{ member.full_name|first|upper }}</span>
                            </div>
                            <span class="font-medium text-gray-800 text-xs">{{ member.full_name }}</span>
                          </div>
                        {% endfor %}
                      </div>
                    {% else %}
                      <p class="text-gray-500 text-sm">No members in this group</p>
                    {% endif %}
                  </div>
                  
                  <!-- Recent Activity -->
                  <div class="px-4 pb-3">
                    <h4 class="text-xs font-medium text-gray-500 uppercase tracking-wider mb-2">Recent Activity</h4>
                    <div class="text-sm text-gray-600 bg-gray-50 p-2 rounded">
                      <div class="flex items-start">
                        <i class="fas fa-comment-dots text-gray-400 mt-0.5 mr-2"></i>
                        <p class="text-xs">Group created by instructor</p>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Group Actions -->
                  <div class="bg-gray-50 px-4 py-3 flex justify-between items-center border-t border-gray-200">
                    <div class="flex space-x-2">
                      <button type="button" onclick="toggleEditForm({{ group.id }})" 
                        class="inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                        <i class="fas fa-edit mr-1"></i>Edit
                      </button>
                      
                      <form method="POST" action="{{ url_for('main.notify_group', group_id=group.id) }}">
                        <button type="submit" class="inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                          <i class="fas fa-bell mr-1"></i>Notify
                        </button>
                      </form>
                    </div>
                    
                    <div class="flex space-x-2">
                      <form method="POST" action="{{ url_for('main.duplicate_group', group_id=group.id) }}">
                        <button type="submit" class="inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                          <i class="fas fa-copy mr-1"></i>Duplicate
                        </button>
                      </form>
                      
                      <form method="POST" action="{{ url_for('main.delete_group', group_id=group.id) }}"
                        onsubmit="return confirm('Are you sure you want to delete this group?');">
                        <button type="submit" class="inline-flex items-center px-3 py-1.5 border border-transparent text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500">
                          <i class="fas fa-trash-alt mr-1"></i>Delete
                        </button>
                      </form>
                    </div>
                  </div>
                  
                  <!-- Inline Edit Form -->
                  <form method="POST" action="{{ url_for('main.edit_group', group_id=group.id) }}" 
                    class="edit-form p-4 bg-gray-50 border-t border-gray-200" id="edit-form-{{ group.id }}" style="display:none;">
                    <h4 class="text-md font-medium text-gray-800 mb-3">Edit Group Details</h4>
                    <div class="space-y-4">
                      <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Group Name</label>
                        <input type="text" name="group_name" value="{{ group.name }}" required 
                          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                      </div>
                      
                      <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Visibility</label>
                        <div class="flex space-x-4">
                          <label class="inline-flex items-center">
                            <input type="radio" name="visibility" value="private" {% if group.visibility == 'private' %}checked{% endif %} class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300">
                            <span class="ml-2 text-sm text-gray-700">Private</span>
                          </label>
                          <label class="inline-flex items-center">
                            <input type="radio" name="visibility" value="public" {% if group.visibility == 'public' %}checked{% endif %} class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300">
                            <span class="ml-2 text-sm text-gray-700">Public</span>
                          </label>
                        </div>
                      </div>
                      
                      <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Task Title</label>
                        <input type="text" name="project_title" value="{{ group.project_title }}" required 
                          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                      </div>
                      
                      <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Task Description</label>
                        <textarea name="task_description" rows="3" required 
                          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">{{ group.task_description }}</textarea>
                      </div>
                      
                      <div class="grid grid-cols-2 gap-4">
                        <div>
                          <label class="block text-sm font-medium text-gray-700 mb-1">Deadline</label>
                          <input type="date" name="deadline" value="{{ group.deadline.strftime('%Y-%m-%d') }}" required 
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        </div>
                        
                        {% if priority_exists %}
                        <div>
                          <label class="block text-sm font-medium text-gray-700 mb-1">Priority</label>
                          <select name="priority" 
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            <option value="low" {% if group.priority == 'low' %}selected{% endif %}>Low</option>
                            <option value="medium" {% if group.priority == 'medium' or not group.priority %}selected{% endif %}>Medium</option>
                            <option value="high" {% if group.priority == 'high' %}selected{% endif %}>High</option>
                          </select>
                        </div>
                        {% endif %}
                      </div>
                    </div>
                    
                    <div class="mt-4 flex justify-end space-x-2">
                      <button type="button" onclick="toggleEditForm({{ group.id }})" 
                        class="inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                        Cancel
                      </button>
                      <button type="submit" 
                        class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                        Save Changes
                      </button>
                    </div>
                  </form>
                </div>
              {% endfor %}
            </div>
          {% else %}
            <div class="bg-white rounded-xl shadow-md p-8 text-center">
              <i class="fas fa-users-slash text-gray-300 text-4xl mb-4"></i>
              <h3 class="text-lg font-medium text-gray-800 mb-2">No Groups Created Yet</h3>
              <p class="text-gray-600">Create your first student group using the form on the left.</p>
            </div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="bg-white mt-12 border-t border-gray-200">
    <div class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
      <div class="md:flex md:items-center md:justify-between">
        <div class="flex justify-center md:justify-start space-x-6">
          <a href="#" class="text-gray-400 hover:text-gray-500">
            <span class="sr-only">Privacy Policy</span>
            Privacy
          </a>
          <a href="#" class="text-gray-400 hover:text-gray-500">
            <span class="sr-only">Terms</span>
            Terms
          </a>
          <a href="#" class="text-gray-400 hover:text-gray-500">
            <span class="sr-only">Help Center</span>
            Help
          </a>
        </div>
        <div class="mt-4 md:mt-0 flex justify-center md:justify-end">
          <p class="text-center text-sm text-gray-500">
            &copy; 2023 EduGroup. All rights reserved.
          </p>
        </div>
      </div>
    </div>
  </footer>

  <script>
    // Toggle edit form visibility
    function toggleEditForm(groupId) {
      const form = document.getElementById(`edit-form-${groupId}`);
      form.style.display = (form.style.display === "none") ? "block" : "none";
    }
    
    // Student selection functionality
    document.addEventListener('DOMContentLoaded', function() {
      const selectAllCheckbox = document.getElementById('select-all-students');
      const studentCheckboxes = document.querySelectorAll('.student-checkbox');
      const selectedCount = document.getElementById('selected-count');
      const searchInput = document.getElementById('student-search');
      const courseFilter = document.getElementById('course-filter');
      const studentItems = document.querySelectorAll('.student-item');
      const sortGroups = document.getElementById('sort-groups');
      const groupsContainer = document.getElementById('groups-container');
      
      // Update selected count
      function updateSelectedCount() {
        const count = document.querySelectorAll('.student-checkbox:checked').length;
        selectedCount.textContent = `${count} selected`;
      }
      
      // Select all functionality
      selectAllCheckbox.addEventListener('change', function() {
        studentCheckboxes.forEach(checkbox => {
          checkbox.checked = selectAllCheckbox.checked;
        });
        updateSelectedCount();
      });
      
      // Individual checkbox change
      studentCheckboxes.forEach(checkbox => {
        checkbox.addEventListener('change', function() {
          updateSelectedCount();
          
          // Update select all checkbox state
          const allChecked = Array.from(studentCheckboxes).every(cb => cb.checked);
          const someChecked = Array.from(studentCheckboxes).some(cb => cb.checked);
          
          selectAllCheckbox.checked = allChecked;
          selectAllCheckbox.indeterminate = someChecked && !allChecked;
        });
      });
      
      // Search functionality
      searchInput.addEventListener('input', function() {
        const searchTerm = this.value.toLowerCase();
        
        studentItems.forEach(item => {
          const studentName = item.getAttribute('data-student-name');
          if (studentName.includes(searchTerm)) {
            item.style.display = 'flex';
          } else {
            item.style.display = 'none';
          }
        });
      });
      
      // Course filter functionality
      courseFilter.addEventListener('change', function() {
        const courseId = this.value;
        
        studentItems.forEach(item => {
          const studentCourseId = item.getAttribute('data-course-id');
          if (!courseId || studentCourseId === courseId) {
            item.style.display = 'flex';
          } else {
            item.style.display = 'none';
          }
        });
      });
      
      // Sort groups functionality
      sortGroups.addEventListener('change', function() {
        const sortBy = this.value;
        const groupItems = Array.from(document.querySelectorAll('.group-item'));
        
        groupItems.sort((a, b) => {
          switch(sortBy) {
            case 'newest':
              // Assuming groups are already in newest order
              return -1;
            case 'oldest':
              // Reverse the order
              return 1;
            case 'name':
              const nameA = a.getAttribute('data-name').toLowerCase();
              const nameB = b.getAttribute('data-name').toLowerCase();
              return nameA.localeCompare(nameB);
            case 'deadline':
              const dateA = new Date(a.getAttribute('data-deadline'));
              const dateB = new Date(b.getAttribute('data-deadline'));
              return dateA - dateB;
            default:
              return 0;
          }
        });
        
        // Clear container and append sorted items
        groupsContainer.innerHTML = '';
        groupItems.forEach(item => groupsContainer.appendChild(item));
      });
      
      // Initialize selected count
      updateSelectedCount();
      
      // Calculate stats
      const totalGroups = document.querySelectorAll('.group-item').length;
      const activeGroups = Math.floor(totalGroups * 0.8); // Simulate 80% active
      const pendingTasks = Math.floor(totalGroups * 1.5); // Simulate 1.5 tasks per group
      
      document.getElementById('active-groups').textContent = activeGroups;
      document.getElementById('pending-tasks').textContent = pendingTasks;
      
      // Form validation
      const groupForm = document.getElementById('group-form');
      if (groupForm) {
        groupForm.addEventListener('submit', function(event) {
          const selectedStudents = document.querySelectorAll('.student-checkbox:checked');
          if (selectedStudents.length < 2) {
            event.preventDefault();
            alert('Please select at least 2 students for the group.');
          }
        });
      }
    });
  </script>
</body>
</html>